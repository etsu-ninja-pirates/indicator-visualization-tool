{% extends "hda_public/base.html" %}
{% block title %}Health Chart{% endblock %}
{% block content %}

<div class="row">
  <ul class="nav nav-pills">
    {% for year in available_years %}
    <li role="presentation" class="{% if selected_year and selected_year == year %}active{% endif %}">
      <a href="{% url 'chart' year %}">{{ year }}</a>
    </li>
    {% endfor %}
  </ul>
</div>

<div class="row">
  {% if data_series %}
  <div id="chartdiv"></div>
  {% else %}
  <p>Please select a year to display data for</p>
  {% endif %}
</div>

{% endblock %}


{% block extra_scripts %}

{% comment %} Highchart script CDN  {% endcomment %}
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>
<!-- optional -->
<script src="http://code.highcharts.com/modules/offline-exporting.js"></script>
<script src="http://code.highcharts.com/modules/export-data.js"></script>

{% if data_series %}
<script>
(function() {
  Highcharts.chart('chartdiv', {
      plotOptions: {
        series: {
          turboThreshold: 3500
        }
      },
      title: {
          text: 'Sample'
      },
      xAxis: {
        title: {
            enabled: true,
            text: 'Percentile'
        }
      },
      yAxis: {
      },
      series: [
        {
          name: 'Percentiles',
          type: "spline",
          data: {{ data_percentiles | safe }},
          color: "gray",
          enableMouseTracking: false,
          marker: {
            enabled: false
          }
        },
        {
          name: 'Values',
          type: "scatter",
          data: {{ data_series | safe }},
          color: 'red',
          allowPointSelect: true,
          tooltip: {
            pointFormat: "{point.name}<br/>p: <b>{point.x}%</b><br/>v: <b>{point.y}</b><br/>",
            valueDecimals: 1,
          },
          marker: {
            radius: 3,
            symbol: "circle"
          }
        } 
      ]
    }
  );
})();

</script>
{% endif %}

{% endblock %}
